<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug - Botones de Repuestos</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-button { 
            background: #007bff; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            margin: 10px; 
            border-radius: 5px; 
            cursor: pointer; 
        }
        #console-output { 
            background: #f8f9fa; 
            border: 1px solid #ddd; 
            padding: 15px; 
            margin-top: 20px; 
            height: 300px; 
            overflow-y: scroll; 
            font-family: monospace; 
        }
    </style>
</head>
<body>
    <h1>🔧 Debug - Botones de Repuestos</h1>
    
    <p>Simula los botones que aparecen en ticket-detail para probar su funcionamiento:</p>
    
    <!-- Simular los botones del ticket-detail -->
    <button id="add-spare-part-btn" class="test-button">
        ➕ Agregar Repuesto
    </button>
    
    <button id="request-spare-part-btn" class="test-button">
        🛒 Solicitar Repuesto
    </button>
    
    <button id="add-first-spare-part" class="test-button">
        🎯 Agregar Primer Repuesto
    </button>
    
    <button onclick="testAPI()" class="test-button">
        🧪 Test API Endpoints
    </button>
    
    <div id="console-output"></div>

    <script>
        // Simular el entorno de ticket-detail
        const API_URL = 'http://localhost:3000/api';
        
        // Función para logging
        function log(message) {
            const output = document.getElementById('console-output');
            output.innerHTML += `<div><strong>${new Date().toLocaleTimeString()}:</strong> ${message}</div>`;
            output.scrollTop = output.scrollHeight;
            console.log(message);
        }
        
        // Simular las funciones que deberían existir
        function showAddSparePartModal() {
            log('✅ showAddSparePartModal() llamada correctamente');
            alert('Modal de Agregar Repuesto se abriría aquí');
        }
        
        function showRequestSparePartModal() {
            log('✅ showRequestSparePartModal() llamada correctamente');
            alert('Modal de Solicitar Repuesto se abriría aquí');
        }
        
        function showNotification(message, type) {
            log(`📢 Notificación (${type}): ${message}`);
        }
        
        // Simular el event listener de delegación
        document.addEventListener('click', (e) => {
            log(`🖱️ Click detectado en: ${e.target.id || e.target.tagName}`);
            
            if (e.target.id === 'add-spare-part-btn' || e.target.closest('#add-spare-part-btn')) {
                e.preventDefault();
                log('🔧 Click en botón agregar repuesto');
                if (typeof showAddSparePartModal === 'function') {
                    showAddSparePartModal();
                } else {
                    log('❌ showAddSparePartModal no está definida');
                }
            }
            
            if (e.target.id === 'add-first-spare-part' || e.target.closest('#add-first-spare-part')) {
                e.preventDefault();
                log('🔧 Click en botón primer repuesto');
                if (typeof showAddSparePartModal === 'function') {
                    showAddSparePartModal();
                } else {
                    log('❌ showAddSparePartModal no está definida');
                }
            }
            
            if (e.target.id === 'request-spare-part-btn' || e.target.closest('#request-spare-part-btn')) {
                e.preventDefault();
                log('🛒 Click en botón solicitar repuesto');
                if (typeof showRequestSparePartModal === 'function') {
                    showRequestSparePartModal();
                } else {
                    log('❌ showRequestSparePartModal no está definida');
                }
            }
        });
        
        async function testAPI() {
            log('🧪 Probando endpoints de la API...');
            
            try {
                const response = await fetch(`${API_URL}/inventory/spare-parts`);
                if (response.ok) {
                    const data = await response.json();
                    log(`✅ API funcionando: ${data.data?.length || 0} repuestos encontrados`);
                } else {
                    log(`❌ API error: ${response.status} ${response.statusText}`);
                }
            } catch (error) {
                log(`❌ Error de conexión: ${error.message}`);
                log('💡 Asegúrate de que el servidor esté ejecutándose en localhost:3000');
            }
        }
        
        // Log inicial
        log('🚀 Debug page cargada. Haz click en los botones para probar.');
        log('📍 Event listeners configurados via delegación');
        
        // Verificar que las funciones existen
        log(`🔍 showAddSparePartModal definida: ${typeof showAddSparePartModal === 'function'}`);
        log(`🔍 showRequestSparePartModal definida: ${typeof showRequestSparePartModal === 'function'}`);
    </script>
</body>
</html>
